class iDatePicker{constructor(e,t="en",a="YYYY-MM-DD"){this.inputElements=e,this.lang=t,this.dateFormat=a,this.calendarElement=null,this.currentDate=new Date,this.selectedDate=null,this.activeInputElement=null,this.init()}init(){this.inputElements.forEach(e=>{e.classList.add("idatepicker"),e.addEventListener("focus",()=>this.onFocusInput(e))}),document.addEventListener("click",e=>this.onClickOutside(e))}renew(e){e.forEach(e=>{e.classList.contains("idatepicker")||(e.classList.add("idatepicker"),e.addEventListener("focus",()=>this.onFocusInput(e)))})}onFocusInput(e){var t=e.value;t&&this.isValidDateFormat(t)?(this.currentDate=this.parseDate(t),this.selectedDate=new Date(this.currentDate)):(this.currentDate=new Date,this.selectedDate=null),this.activeInputElement=e,this.showCalendar(e)}onClickOutside(e){!this.calendarElement||e.target.closest(".datepicker")||e.target.closest(".idatepicker-calendar")||this.hideCalendar()}showCalendar(e){this.calendarElement&&this.calendarElement.remove(),this.calendarElement=this.createElement("div",{position:"absolute",backgroundColor:"#fff",fontSize:"12px",padding:"8px",border:"1px solid #ccc",borderRadius:"5px",boxSizing:"border-box",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.2)",zIndex:"100"},"idatepicker-calendar"),document.body.appendChild(this.calendarElement);var t=e.getBoundingClientRect();this.calendarElement.style.top=t.bottom+window.scrollY+"px",this.calendarElement.style.left=t.left+window.scrollX+"px",this.buildCalendar(e)}hideCalendar(){this.calendarElement&&(this.calendarElement.remove(),this.calendarElement=null)}buildCalendar(e){var t=this.currentDate.getFullYear(),a=this.currentDate.getMonth(),n=(this.calendarElement.innerHTML="",this.createHeader()),t=this.createCalendarTable(t,a,e);this.calendarElement.appendChild(n),this.calendarElement.appendChild(t)}createHeader(){var e=this.createElement("div",{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"5px 0px 10px 0px"}),t=this.createButton("ðŸž€","prev-month",()=>this.changeMonth(-1)),a=this.createElement("span",{fontSize:"14px",fontWeight:"bold"}),n=(a.textContent=this.currentDate.toLocaleString("en"===this.lang?"en":"zh",{month:"short"})+" / "+this.currentDate.getFullYear(),this.createButton("ðŸž‚","next-month",()=>this.changeMonth(1)));return e.appendChild(t),e.appendChild(a),e.appendChild(n),e}createButton(e,t,a){var n=this.createElement("button",{position:"relative",backgroundColor:"#2ca4e9",fontSize:"12px",color:"#fff",padding:"3px 6px",border:"none",borderRadius:"3px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)",boxSizing:"border-box",cursor:"pointer"});return n.id=t,n.textContent=e,n.addEventListener("click",e=>{e.stopPropagation(),a()}),n}changeMonth(e){this.currentDate.setMonth(this.currentDate.getMonth()+e),this.buildCalendar(this.inputElements[0])}createCalendarTable(e,t,a){var n=this.createElement("table",{width:"100%",borderCollapse:"collapse"}),r=this.createTableHeader(),e=this.createTableBody(e,t,a);return n.appendChild(r),n.appendChild(e),n}createTableHeader(){var e=document.createElement("thead");const a=document.createElement("tr");return("en"===this.lang?["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]:["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"]).forEach(e=>{var t=this.createElement("th",{width:"36px",height:"30px",fontSize:"12px",color:"#2ca4e9",padding:"4px",border:"1px solid #e6e6e6",boxSizing:"border-box",textAlign:"center"});t.textContent=e,a.appendChild(t)}),e.appendChild(a),e}createTableBody(n,r,i){var e=document.createElement("tbody"),l=new Date(n,r,1).getDay(),s=new Date(n,r+1,0).getDate();let d=new Date(n,r,0).getDate()-l+1,o=1,c=1;for(let a=0;a<6;a++){var h,p,u=document.createElement("tr");for(let t=0;t<7;t++){let e;e=0===a&&t<l?(h=this.formatDate(new Date(n,r-1,d++)),this.createDateCell(d-1,h,i,!0)):o>s?(h=this.formatDate(new Date(n,r+1,c)),this.createDateCell(c++,h,i,!0)):(p=this.formatDate(new Date(n,r,o)),this.createDateCell(o++,p,i,!1)),u.appendChild(e)}e.appendChild(u)}return e}createDateCell(e,t,a,n){n=this.createElement("td",{backgroundColor:this.selectedDate&&t===this.formatDate(this.selectedDate)?"#2ca4e9":"",width:"36px",height:"30px",fontSize:"12px",color:n?"#aaa":this.selectedDate&&t===this.formatDate(this.selectedDate)?"#fff":"",padding:"4px",border:"1px solid #e6e6e6",boxSizing:"border-box",textAlign:"center",cursor:"pointer"});return n.dataset.date=t,n.textContent=e,n.addEventListener("click",()=>this.onDateSelect(t,a)),n}onDateSelect(e,t){e=this.parseDate(e);isNaN(e)||(this.activeInputElement.value=this.formatDate(e),this.selectedDate=e,this.buildCalendar(t),this.hideCalendar())}createElement(e,t={},a){e=document.createElement(e);return a&&(e.className=a),Object.assign(e.style,t),e}isValidDateFormat(e){let t;return(t="DD/MM/YYYY"===this.dateFormat.toString().toUpperCase()?/^(0[1-9]|[12][0-9]|3[01])\/(0[1-9]|1[0-2])\/\d{4}$/:/^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$/).test(e)}parseDate(e){var[e,t,a]="DD/MM/YYYY"===this.dateFormat.toString().toUpperCase()?e.split("/").map(Number).reverse():e.split("-").map(Number);return new Date(e,t-1,a)}formatDate(e){var t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),e=String(e.getDate()).padStart(2,"0");return"DD/MM/YYYY"===this.dateFormat.toString().toUpperCase()?e+`/${a}/`+t:t+`-${a}-`+e}}